<!-- src/main/resources/templates/factura/view.html -->
<!DOCTYPE html><html xmlns:th="http://www.thymeleaf.org"><head>
<meta charset="UTF-8"><title>Factura</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"></head>
<body class="container py-4">
  <h1 class="h4 mb-3">Factura <span th:text="${factura.numeroFactura}"></span></h1>
  <div class="mb-3">
    <div>Fecha: <strong th:text="${factura.fechaFactura}"></strong></div>
    <div>Socio: <strong th:text="${factura.socioNombre}"></strong></div>
    <div>Estado: <strong th:text="${factura.estado}"></strong></div>
    <div th:if="${factura.formaDePagoTexto}">Pago: <strong th:text="${factura.formaDePagoTexto}"></strong></div>
  </div>

  <table class="table table-bordered">
    <thead><tr><th>Mes</th><th>Año</th><th>Importe</th></tr></thead>
    <tbody>
      <tr th:each="d : ${factura.detalles}">
        <td th:text="${d.mes}"></td>
        <td th:text="${d.anio}"></td>
        <td th:text="${d.importe}"></td>
      </tr>
    </tbody>
    <tfoot>
      <tr><th colspan="2" class="text-end">Total</th><th th:text="${factura.totalPagado}"></th></tr>
    </tfoot>
  </table>

  <form class="mt-3" th:action="@{|/admin/facturas/${factura.id}/anular|}" method="post"
        th:if="${factura.estado.name() != 'ANULADA'}">
    <div class="input-group">
      <input class="form-control" name="motivo" placeholder="Motivo de anulación (opcional)">
      <button class="btn btn-outline-danger" onclick="return confirm('¿Anular la factura?')">Anular</button>
    </div>
  </form>

  <div class="mt-3"><a th:href="@{/admin/facturas}" class="btn btn-secondary">Volver</a></div>
</body></html>
